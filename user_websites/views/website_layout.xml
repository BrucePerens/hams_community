<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="layout_inherit_report_violation" inherit_id="website.layout" name="Report Violation Global">
        
        <xpath expr="//footer" position="after">
            <t t-call="user_websites.report_violation_modal"/>
        </xpath>

        <xpath expr="//footer" position="before">
            <t t-set="is_user_content" t-value="False"/>
            <t t-set="is_owner" t-value="False"/>

            <t t-if="main_object">
                <t t-if="main_object and '_fields' in main_object">
                    
                    <t t-if="'owner_user_id' in main_object._fields and main_object.owner_user_id">
                         <t t-if="main_object.owner_user_id.website_slug">
                            <t t-set="is_user_content" t-value="True"/>
                            <t t-if="main_object.owner_user_id == request.env.user">
                                <t t-set="is_owner" t-value="True"/>
                            </t>
                        </t>
                    </t>
                    
                    <t t-if="not is_user_content and 'user_websites_group_id' in main_object._fields and main_object.user_websites_group_id">
                        <t t-set="is_user_content" t-value="True"/>
                        <t t-if="request.env.user in main_object.user_websites_group_id.odoo_group_id.user_ids">
                            <t t-set="is_owner" t-value="True"/>
                        </t>
                    </t>

                </t>
            </t>

            <t t-if="not is_user_content">
                <t t-if="profile_user">
                    <t t-set="is_user_content" t-value="True"/>
                    <t t-if="profile_user == request.env.user">
                        <t t-set="is_owner" t-value="True"/>
                    </t>
                </t>
                <t t-elif="profile_group">
                    <t t-set="is_user_content" t-value="True"/>
                    <t t-if="request.env.user in profile_group.odoo_group_id.user_ids">
                        <t t-set="is_owner" t-value="True"/>
                    </t>
                </t>
            </t>

            <t t-if="is_user_content and not is_owner">
                <div class="container mt-4 mb-4 border-top pt-3">
                    <t t-call="user_websites.report_violation_snippet"/>
                </div>
            </t>
        </xpath>
    </template>
</odoo>
